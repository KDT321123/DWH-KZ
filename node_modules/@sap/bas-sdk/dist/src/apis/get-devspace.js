"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDevspaceInfo = void 0;
const axios_1 = __importDefault(require("axios"));
const url_join_1 = __importDefault(require("url-join"));
const core_utils_1 = require("../utils/core-utils");
const destinations_1 = require("../utils/destinations");
const devspace_utils_1 = require("../utils/devspace-utils");
/**
 * Return information about the current workspace.
 *
 * @returns - devspace information
 */
async function getDevspaceInfo() {
    const devspaceId = core_utils_1.getEnvValue("WORKSPACE_ID").replace("workspaces-", "");
    const url = url_join_1.default(core_utils_1.getEnvValue(destinations_1.ENV_H2O_URL), `/ws-manager/api/v1/workspace/${devspaceId}`);
    let response;
    try {
        response = await axios_1.default.get(url);
    }
    catch (error) {
        const errorDetail = error instanceof Error ? `Error message: ${error.message}.` : "";
        throw new Error(`Couldn't retrieve devspace information from the (${url}) URL. ${errorDetail}`);
    }
    const devspaceInfo = devspace_utils_1.flattenDevspaceInfo(response.data);
    return devspaceInfo;
}
exports.getDevspaceInfo = getDevspaceInfo;
//# sourceMappingURL=get-devspace.js.map