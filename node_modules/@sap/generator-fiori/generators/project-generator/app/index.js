"use strict";exports.id=2,exports.ids=[2],exports.modules={38953:function(e,t,a){var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=a(37705),r=a(1628),i=a(16920);t.generateReadMe=i.generateReadMeExt;const s=a(57147),c=a(71017),p=o(a(52375)),l=a(43895);t.applyFioriToolsUpdates=function(e,{appId:t,ui5Theme:a,localOnly:o,serviceClient:s,apiHubApiKey:u},d){e.extendJSON(c.join(d,"package.json"),{sapuxLayer:r.assignSapUxLayerValue(!1,n.isInternalFeaturesSettingEnabled())}),function(e,t,a,o){const n=["server","customMiddleware"],r={name:"fiori-tools-preview",afterMiddleware:"fiori-tools-appreload",configuration:{component:a,ui5Theme:o}},i=p.parseDocument(e.read(c.join(t,"ui5.yaml")));i.addIn(n,r),e.write(c.join(t,"ui5.yaml"),i.toString());const s=p.parseDocument(e.read(c.join(t,"ui5-local.yaml")));s.addIn(n,r),e.write(c.join(t,"ui5-local.yaml"),s.toString())}(e,d,t,a),function(e,t,a,o){const n="#preview-app",i=e.readJSON(c.join(t,"package.json"));if("object"==typeof i.scripts){let s;if(a)s=`echo \\"${r.t("MOCK_ONLY_WARNING")}\\"`;else{const e=o?`&sap-client=${o}`:"";s=`fiori run --open "preview.html${r.buildUrlParam(e,r.DisableCacheParam,"fiori-tools-rta-mode=true","sap-ui-rta-skip-flex-validation=true")}${n}"`}i.scripts["start-variants-management"]=s,e.writeJSON(c.join(t,"package.json"),i)}}(e,d,o,s),u&&l.isAppStudio()&&i.createAPIHubKeyFiles(e,d,u)},t.applyCAPUpdates=async function(e,t,{service:{capService:a},project:{sapux:o,skipAnnotations:n}},p,l){const u=a=>{const o=c.join(t,a);e.exists(o)&&e.delete(o)};u(".gitignore"),u(".npmignore"),u("ui5-local.yaml"),u("ui5-mock.yaml"),u("./webapp/index.html"),n||i.updateCdsFiles(e,a,p.package.name),await i.updateRootPackageJsonCAP(e,p.package.name,o,a,l),a.capType===r.CapType.JAVA&&i.applyCAPJavaUpdates(e,a.projectPath);let d=!1;s.existsSync(c.join(__dirname,"..","templates"))&&(d=!0),e.copyTpl(c.join(__dirname,""+(d?"":".."),"..","templates","cap","add","**/*.*"),t,{...p,escapeFLPText:e=>e.replace(/\\/g,"\\\\").replace(/(")/g,"\\$&")})}},89546:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=a(1628);function n(e,t,a=!0){let n=e?o.buildUrlParam(t,o.DisableCacheParam):"";return n&&!a&&(n=n.substring(1,n.length)),n}t.getMockTaskOpenArgs=function(e,t=!1,a,r,i=!0){const s=r?`#${r}`:"",c=`${n(i,a)}${s??""}`;if(t){return{[o.ODataVersion.v2]:["--open",`test/flpSandboxMockServer.html${c}`],[o.ODataVersion.v4]:["--config","./ui5-mock.yaml","--open",`test/flpSandbox.html${c}`]}[e]}return["--config","./ui5-mock.yaml","--open",`test/flpSandbox.html${c}`]},t.getStartTasksOpenArg=function(e,t="",a="",r,i,s,c=!0){const p=a.replace("#",""),l=p?`#${p}`:"";let u;if(s){u=`#${s.replace("#","")}`}const d=n(c,t);return{startCommandOpenArg:e?"":`${r||"test/flpSandbox.html"}${d}${l}`,startLocalCommandOpenArg:`${i||"test/flpSandbox.html"}${d}${u||l}`,startNoFlpCommandOpenArg:e?"":`index.html${d}`,startVariantsCommandOpenArg:`\\"preview.html${o.buildUrlParam(t,o.DisableCacheParam,"fiori-tools-rta-mode=true","sap-ui-rta-skip-flex-validation=true")}#preview-app\\""`}},t.getUrlParam=n,t.getLocalStartFile=function(e){let t;return t=e.isFioriElement&&e.odataVersion===o.ODataVersion.v2&&!0===e.isMigrator?"test/flpSandboxMockServer.html":e.flpSandboxAvailable?"test/flpSandbox.html":"index.html",t},t.getStartFile=function(e){return e?"test/flpSandbox.html":"index.html"},t.getLocalOnly=function(e){return"File"===e}},99446:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=a(43895),n=a(71017),r=a(89546);t.getDebugConfigs=function(e,t,a,i){const s=r.getLocalOnly(t.datasourceType),c=r.getStartFile(t.flpSandboxAvailable),p=`{"handlerId":"fiori_tools","runnableId":"${t.projectPath}"}`,l={version:"0.2.0",configurations:[]},u=r.getLocalStartFile(t),d=r.getUrlParam(!0,t.sapClientParam,!1),{startCommandOpenArg:m,startLocalCommandOpenArg:f}=r.getStartTasksOpenArg(s,t.sapClientParam,t.flpAppId,c,u,t.migratorMockIntent,!1),g=void 0!==t.odataVersion?r.getMockTaskOpenArgs(t.odataVersion,t.isMigrator,t.sapClientParam,t.flpAppId,!1):void 0,h=n.posix.sep+t.projectName,P=i?n.posix.sep+i:"",S=`\${workspaceFolder}${a?h:P}`,C={name:`Start ${t.projectName}`,type:"node",request:"launch",runtimeExecutable:"npx",cwd:S,windows:{runtimeExecutable:"npx.cmd"},runtimeArgs:["fiori","run"],args:["--open",m],console:"internalConsole",internalConsoleOptions:"openOnSessionStart",outputCapture:"std",port:9229,env:{DEBUG:"--inspect",FIORI_TOOLS_URL_PARAMS:d}},j={name:`Start ${t.projectName} Local`,type:"node",request:"launch",cwd:S,runtimeExecutable:"npx",windows:{runtimeExecutable:"npx.cmd"},runtimeArgs:["fiori","run"],args:["--config","./ui5-local.yaml","--open",f],console:"internalConsole",internalConsoleOptions:"openOnSessionStart",outputCapture:"std",port:9229,env:{FIORI_TOOLS_URL_PARAMS:d}};o.isAppStudio()&&(C.env["run.config"]=p,j.env["run.config"]=p),"File"!==t.datasourceType&&l.configurations.push(C);const _={liveConfiguration:C,localConfiguration:j,launchFile:l};if(g){const e={name:`Start ${t.projectName} Mock`,type:"node",request:"launch",cwd:S,runtimeExecutable:"npx",windows:{runtimeExecutable:"npx.cmd"},runtimeArgs:["fiori","run"],args:g,console:"internalConsole",internalConsoleOptions:"openOnSessionStart",outputCapture:"std",port:9229,env:{FIORI_TOOLS_URL_PARAMS:d}};o.isAppStudio()&&(e.env["run.config"]=p),l.configurations.push(e),_.mockConfiguration=e}return l.configurations.push(j),_[e]}},48478:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=a(18571);t.generateLaunchConfig=o.generateLaunchConfig},18571:function(e,t,a){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(99446),r=a(71017),i=o(a(57147)),s=a(66897),c=a(77090),p=a(398),l=a(34328);function u(e,t){i.default.writeFileSync(r.join(e,"launch.json"),JSON.stringify(t,null,4),"utf8")}function d(e,t,a,o,n=!0){const s=r.join(r.dirname(e),t),c=r.join(s,".vscode"),p=o.Uri&&o.Uri.file(s);if(i.default.mkdirSync(c,{recursive:!0}),u(c,a),p){const e=o.workspace.workspaceFolders?o.workspace.workspaceFolders.length:0;!l.isAppStudio()&&n&&o.workspace.updateWorkspaceFolders(e,void 0,{name:t,uri:p})}return!0}function m(e,t){if(t.workspace){let a=!1;return t.workspace.workspaceFolders&&t.workspace.workspaceFolders.map((t=>{t.uri.fsPath&&e.toLowerCase().includes(t.uri.fsPath.toLowerCase())&&(a=!0)})),a||void 0===t.workspace.workspaceFolders}}function f(e,t,a,o=!0){if(!t)return;let p,l,f,g;const h=(t=!0,a)=>{p=n.getDebugConfigs("liveConfiguration",e,t,a),l=n.getDebugConfigs("mockConfiguration",e,t,a),f=n.getDebugConfigs("localConfiguration",e,t,a),g=n.getDebugConfigs("launchFile",e,t,a)};if(h(!0),t.workspace&&!t.workspace.workspaceFile)if(m(e.projectPath,t)){const o=t.workspace.getWorkspaceFolder(t.Uri.file(e.projectPath)).uri.fsPath;h(!1,r.relative(o??e.projectPath,e.projectPath));const n=t.workspace.getConfiguration("launch");"File"!==e.datasourceType&&n.configurations.push(p),l&&n.configurations.push(l),n.configurations.push(f);try{t.workspace.getConfiguration().update("launch",n)}catch(e){a?.error(s.t("ERROR_LAUNCH_FILE",{error:e}))}}else h(!1),d(e.projectPath,e.projectName,g,t,o);if(!t.workspace||t.workspace.workspaceFile||t.workspace.workspaceFolders||(h(!1),d(e.projectPath,e.projectName,g,t,o)),t.workspace&&t.workspace.workspaceFile&&"file"===t.workspace.workspaceFile.scheme){const a=r.join(r.dirname(e.projectPath),".vscode");if(m(e.projectPath,t))if(i.default.existsSync(a))try{const t=r.join(a,"launch.json");if(i.default.statSync(t)){const o=JSON.parse(i.default.readFileSync(t,"utf8").replace(/\\"|"(?:\\"|[^"])*"|(\/\/.*|\/\*[\s\S]*?\*\/)/g,((e,t)=>t?"":e)));"File"!==e.datasourceType&&o.configurations.push(p),e.odataVersion!==c.ODataVersion.v4&&l&&o.configurations.push(l),o.configurations.push(f),u(a,o)}}catch(e){"ENOENT"===e.code&&u(a,g)}else i.default.mkdirSync(a),u(a,g);else h(!1),d(e.projectPath,e.projectName,g,t,o)}t.workspace&&t.workspace.workspaceFile&&"file"!==t.workspace.workspaceFile.scheme&&(h(!1),d(e.projectPath,e.projectName,g,t,o))}t.generateLaunchConfig=function({source:e,version:t,name:a,targetFolder:o,sapClientParam:n,flpAppId:i,flpSandboxAvailable:c,isFioriElement:l,migratorMockIntent:u,isMigrator:d},m,g=p.DefaultLogger,h=!0){if("Local Cap"===e)g.info(s.t("TO_START_APP",{npmStart:"`npm start`",cdsRun:"`cds run --in-memory`"}));else{const p="File"===e?"run start-mock":"start";f({datasourceType:e,odataVersion:t,projectName:a,projectPath:r.join(o,a),sapClientParam:n,flpAppId:i,flpSandboxAvailable:c,isFioriElement:l,migratorMockIntent:u,isMigrator:d},m,g,h),g.info(s.t("TO_START_SERVER_MESSAGE",{folder:a,npmCommand:p}))}},t.launchFileCreator=u,t.launchConfigForAppsOutsideOfWorkspace=d,t.checkForFolderInWorkspace=m,t.launchConfigGenerator=f},16920:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=a(74448),n=a(43895),r=a(1628),i=a(71017),s=a(32855),c=a(90339),p=a(55920),l=a(52375);function u(e,{project:t,service:a,readMe:o}){let n;"SAP System"===a.source&&(n=`SAP System (${r.t("LABEL_SAP_SYSTEM_SOURCE_TYPE_"+(a.scp?"SCP":"ON_PREM"))})`);let s=r.t("TEXT_LAUNCH_DEFAULT");a.capService&&(s=c.capLaunchText(a.capService.capType,t.name));const p={genDate:o?.genDate||(new Date).toString(),genPlatform:o?.genPlatform||r.getPlatform().name,dataSourceLabel:n||a.source,metadataFilename:a.localEdmxFilePath?i.basename(a.localEdmxFilePath):"",serviceUrl:(a.host??"")+(a.servicePath??"")||r.t("TEXT_NOT_APPLICABLE"),projectName:t.name,projectTitle:t.title,projectDescription:t.description,projectNamespace:t.namespace,ui5Theme:t.ui5Theme,projectUI5Version:o?.projectUI5Version||t.ui5Version,enableCodeAssist:t.enableCodeAssist,enableEslint:t.enableEslint,showMockDataInfo:!!a.edmx,genVersion:o?.genVersion||"",templateLabel:o?.templateLabel||"",genId:o?.genId||"",additionalEntries:[],launchText:s};o?.additionalEntries&&(p.additionalEntries=o.additionalEntries),e("README.md",p)}function d(e,t,a){try{const a=e.read(t).toString(),o=p.xml2js(a,{compact:!0}),n="spring-boot-maven-plugin";if(0===Object.keys(o).length)return;if(o?.project?.build?.plugins?.plugin){const a=o.project.build.plugins.plugin;Array.isArray(a)&&a.length>0?a.forEach((e=>{e.artifactId._text===n&&e.configuration&&void 0===e.workingDirectory&&(e.configuration.workingDirectory={_text:".."})})):a.artifactId._text===n&&a.configuration&&void 0===a.workingDirectory&&(a.configuration.workingDirectory={_text:".."}),o.project.build.plugins.plugin=a;const r=p.js2xml(o,{compact:!0,ignoreComment:!0,spaces:4}),i=/&amp;gt/g;e.write(t,r.replace(i,"&gt"))}}catch(e){a.logErrorMsgs(e)}}function m(e,t,a,o){try{const o=l.parse(e.read(t).toString());void 0===o.spring["web.resources.static-locations"]&&(o.spring["web.resources.static-locations"]=`file:./${a}`,e.write(t,l.stringify(o)))}catch(e){o.logErrorMsgs(e)}}t.updateCdsFiles=async function(e,t,a){const s=r.getAnnotationPath(a,t?.appPath);t.serviceCdsPath=await o.toReferenceUri({root:t.projectPath},s,t.serviceCdsPath),e.write(i.join(t.projectPath,t.appPath,a,"annotations.cds"),`using ${t.serviceName} as service from '${t.serviceCdsPath}';`);const c=i.join(t.projectPath,t.appPath,"index.cds"),p=i.join(t.projectPath,t.appPath,"services.cds"),l=`\nusing from './${n.toPosixPath(i.join(a,"annotations"))}';`;e.exists(c)?e.append(c,l):e.exists(p)?e.append(p,l):e.write(p,l)},t.updateRootPackageJsonCAP=async function(e,t,a,p,l){const u=i.join(p.projectPath,"package.json"),d=e.readJSON(u);if(p.capType===r.CapType.NODE_JS){const a=await r.checkCDSInstalled();if(a&&s.satisfies(a,`>=${r.MIN_CDS_SCRIPT_VERSION}`)){const a=c.getCDSTask(t);e.extendJSON(u,{scripts:a})}else l&&l.warn(r.t("WARNING_CDS_DK_NOT_INSTALLED",{cdsVersion:a??"",minCdsVersion:r.MIN_CDS_SCRIPT_VERSION}))}if(a){const a=n.toPosixPath(i.join(p.appPath||o.CAP_APPS_FOLDER,t));let r=d?.sapux;Array.isArray(r)?r.push(a):r=[a],e.extendJSON(u,{sapux:r})}},t.generateReadMeExt=function(e,{project:t,service:a,readMe:o},n){return u(function({fileName:e,destPath:t,fsEditor:a}){let o=!1;a.exists(i.join(__dirname,"..","templates",e))&&(o=!0);return(e,n)=>{a.copyTpl(i.join(__dirname,""+(o?"":".."),"..","templates",e),i.join(t,e.replace(/\.tmpl|-cap-tmpl/g,"")),n)}}({fileName:"README.md",destPath:e,fsEditor:n}),{project:t,service:a,readMe:o}),n},t.generateReadMe=u,t.updatePomXml=d,t.updateApplicationYaml=m,t.applyCAPJavaUpdates=function(e,t){const a=o.getCapCustomPaths(t),n=new r.ErrorHandler,s=i.join(t,"pom.xml");e.exists(s)&&d(e,s,n);const c=i.join(t,a.srv,"src","main","resources","application.yaml");e.exists(c)&&m(e,c,a.app,n)},t.createAPIHubKeyFiles=function(e,t,a){e.write(`${t}/.env`,`${r.API_HUB_API_KEY}=${a}`)}},90339:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=a(1628);t.capLaunchText=(e,t)=>{let a,n="";return e===o.CapType.JAVA?(n=" (```mvn spring-boot:run```)",a=`http://localhost:8080/${t}/webapp/index.html`):void 0!==e&&e!==o.CapType.NODE_JS||(a=`http://localhost:4004/${t}/webapp/index.html`),`${o.t("TEXT_LAUNCH_CAP",{mvnCommand:n,capUrl:a})}`},t.getCDSTask=function(e){return{[`watch-${e}`]:`cds watch --open ${e}/webapp/index.html?${o.DisableCacheParam}`}}},81979:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=a(48478);t.generateLaunchConfig=o.generateLaunchConfig,function(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}(a(38953))}};